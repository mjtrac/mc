== Camel Example Spring Boot MitchConnect

This example shows how to receive and forward SSL encrypted
messages via MLLP. It logs the messages to a SQLite database
in its toplevel directory.  It also includes sample yaml 
routes for sending and receiving without SSL.

Once you see the "Completed initialization in x ms" message,
you can point a web browser to localhost:8080/api/routes2
to see the loaded routes, and to localhost:8080/api/routes2/load
to load a valid yaml file route
or enter valid yaml text to create a route.

If the entered yaml is not valid it will not load but there
will be no message.  If it is valid you will see it when
your browser is redirected to /api/routes2.

You can Stop and Suspend routes.  Stopped or suspended routes
can be Started.

The application.yaml file is in src/main/resources, and keystore
and truststore and port information is under camel: mllp: ssl:
for the SSL route and camel: mllp: nossl: for the unsecured send
and receive routes.

Routes under src/main/resources/loadedroutes are loaded on startup;
routes in src/main/resources/unloadedroutes include hello.yaml 
and hello2.yaml, which just write to the log every two 
and five seconds.  (These are suitable routes to load via 
http://localhost:8080/api/routes2/load or the button on 
http://localhost:8080/api/routes2.)

Some of the listed routes (the DB routes) are just present
and more or less irrelevant; src/main/ssl2/yamlMllpSslRoute.yaml
shows a call to jdbc which writes to the SQLite database
at mydata.db, configured in application.yaml. To prevent the
yamlMllpSslRoute from failing for lack of that db file,
the one line call is commented out with an explanation.

For the sending route to send, place a valid HL7v2 message
in /tmp/hl7msg.txt.  Once sent, it will be moved
to /tmp/sentmessages.

Beware: this is more a learning experience product than anything
showing best practices.  Still, it provides one path to follow
should you run into trouble getting started on something similar.

If you are just exploring the Camel and Spring Boot combo,
please note that Kaoto is a fantastic open source yaml route
graphical designer, and you can use Jconsole to look at route
statistics.  Adding interceptor routines to log all incoming
messages on certain routes is also made straightforward, and
it is easy to swap in different databases.

=== How to run

You can run this example by installing Java 21 and maven and using

    mvn spring-boot:run

=== Help and contributions

This is an in-progress hobby-level effort, and I am by no means
an expert on Camel or Spring Boot or SSL/TLS.  I just realize that
Mirth Connect is going proprietary, that it charges for SSL,
and have long thought that Apache Camel may offer an alternative.

If you hit any problem using Camel or have some feedback on Camel, then please
https://camel.apache.org/support.html[let the Camel Riders know].

If you have questions or comments about this example, which will
develop further along an unknown schedule,
let me know at mjtrac@gmail.com.  Please especially let me know
if you have problems building it; Java 21, maven, and mvn spring-boot:run
should suffice.

Thanks.

Mitch Trachtenberg

=== Images 

The files are in the images directory if they don't render for you
in this document.

==== Wireshark screen caps:

image::images/Unsecured1.png[]

image::images/Unsecured2.png[]

image::images/SSL.png[]

==== Debug output (with SSL debugging)

image::images/UnsecuredSendOutput.png[]

image::images/UnsecuredRcvOutput.png[]

image::images/SecuredRcvAndForwardOutput.png[]

==== Route Management Screen /api/routes2[]

image::images/RouteManagement.png[]

