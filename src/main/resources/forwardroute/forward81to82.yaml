
- route:  
    id: encompassingMllpRoute  
    from:  
      uri: "mllp://0?hostname=localhost&port=15681&autoAck=false"  
      steps:
        - log: "In steps."
        - bean:
            beanType: "AddMllpFramingProcessor"
            method: "process"
        - log: "In steps after add."
        - to: "netty:tcp://0?host=localhost&port=15682&sync=true"
        - log: "In steps after send to 15682. ${body}"
        - bean:
            beanType: "RemoveMllpFramingProcessor"
            method: "process"
        - log: "In steps after remove. [${body}]"
#        - setHeader:
#            name: "CamelMllpAcknowledgementString"
#            simple: "${body}"
        - setProperty:
            name: "CamelMllpAcknowledgementString"
            simple: "${body}"            
        - log: "In steps after setProperty ${headers}"
        - bean:  
            beanType: "MllpProcessor"  
            method: "callInnerMllp"  
        - log: "Route ends: [${body}]"
        - log: "Route ends: [${header.CamelMllpAcknowledgementString}]"

#        - to:  
#            uri: "mllp://0?hostname=localhost&port=15681&autoAck=false" # send the response back to the original sender.  
#        - log: "Just after to: ${body}"

